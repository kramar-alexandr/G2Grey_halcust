/* Haeukrtb2.hal*/external inner function string 60 UserDefined(string,string);event DefineWindowsbegin  real i,h,h1,h2,h3,h4,h5,h6,h7,v,l,vs,v2,vm,f,t,fs;  string 255 label;  record UserVC Usr;  SetLangMode(LangUkrainian,"UKR",0);   WindowBegin("Визначте проект",PRTSSClass,CGslist,-);  SetWRect(20,80,600,298);  Sizeable(-1,-1,0,0);  UseView(PRVc);  SpawnClass(PRDClass);  RecordList(4,17,-21,-39);  RlColKey(4,1,    "Проект",Code,false,ActCode);  RlColKey(131,131,  "Старший",MotherCode,false,MotherCode);  RlColKey(211,211,"Тип",PRClass,false,ActPRClass);  RlColKey(231,231,"Стадія",PRStage,false,ActPRStage);  RlColKey(301,301,"Опис",Name,false,ActName);  SearchField("Пошук");  EndWindow;  //===  WindowBegin("Визначте проект",PRTSTSSClass,CGslist,-);  SetWRect(20,80,700,298);  Sizeable(-1,-1,0,0);  UseView(PRVc);  SpawnClass(PRDClass);  RecordList(4,17,-21,-39);  RlColKey(4,1,    "Проект",Code,false,TSCode);  RlColKey(131,131,  "Старший",MotherCode,false,TSMotherCode);  RlColKey(211,211,"Тип",PRClass,false,TSPRClass);  RlColKey(261,261,"Стадія",PRStage,false,TSPRStage);  RlColKey(310,310,"Опис",Name,false,TSName);  SearchField("Пошук");  EndWindow;    WindowBegin("Визначте проект",PRTSQTSClass,CGslist,-);  SetWRect(20,80,600,298);  Sizeable(-1,-1,0,0);  UseView(PRVc);  SpawnClass(PRDClass);  RecordList(4,17,-21,-39);  RlColKey(4,1,    "Проект",Code,false,QTCode);  RlColKey(131,131,  "Старший",MotherCode,false,QTMotherCode);  RlColKey(211,211,"Тип",PRClass,false,QTPRClass);  RlColKey(231,231,"Стадія",PRStage,false,QTPRStage);  RlColKey(301,301,"Опис",Name,false,QTName);  SearchField("Пошук");  EndWindow;  //===    usr.Code = currentuser;	if (readfirstmain(USr,1,true)) then begin end;  WindowBegin("Проекти",PRLClass,CGmlist,-); // !!!!!!!!!  SetWRect(20,80,650,298);  SpawnClass(PRDClass);  Sizeable(-1,-1,0,0);  UseView(PRVc);  FormName(PrintPRL);  RecordList(4,17,-21,-39);  RlColKey(4,1,    "Проект",Code,false,PRCode); // 62  RlColKey(75,75,  "Продав.",PrSalesMan,false,PrSalesMan);  RlColKey(131,131,"Статус",StatMark,false,StatMark);  RlColKey(171,171," Тип",PRClass,false,PRClass);  RlColKey(211,211,"Фаза",PRStage,false,PRStage);  RlColKey(261,261,"Клієнт",CustCode,false,CustCode);  RlColKey(341,341,"Найменування",CustName,false,CustName);  RlColKey(471,471,"Опис",Name,false,Name);  SearchField("Пошук");  BrowseSubsetButton(-40,-15);  SpecialMenu("Інформація про проект",'I',0,"PRInfoPRLsm");  SpecialMenu("Пошук проекту",'F',6,"SearchPRLsm");  EndWindow;  WindowBegin("Визначте проект",PRSClass,CGslist,-);// !!!!!!!!!  SetWRect(20,80,700,298);  Sizeable(-1,-1,0,0);  UseView(PRVc);  SpawnClass(PRDClass);  RecordList(4,17,-21,-39);  RlColKey(4,1,    "Проект",Code,false,ActCode);  RlColKey(75,75,  "Продав.",PrSalesMan,false,ActPRLeader);  RlColKey(131,131,"Статус",StatMark,false,ActStatMark);  RlColKey(171,171,"Тип",PRClass,false,ActPRClass);  RlColKey(211,211,"Фаза",PRStage,false,ActPRStage);  RlColKey(261,261,"Клієнт",CustCode,false,ActCustCode);  RlColKey(341,341,"Найменування",CustName,false,ActCustName);  RlColKey(471,471,"Опис",Name,false,ActName);  SearchField("Пошук");  BrowseSubsetButton(-40,-15);  EndWindow;   WindowBegin("Запис операції по проекту",TBIVDClass,CGview,-);  SetWRect(20,80,670,460);//  Sizeable(-1,-1,0,0);  UseView(TBIVVc);  vs=20; h=80;h2=h+170;  Tile(0,20+28,false,"",PRCode);  TileButton(1,"Різне");  TileButton(2,"Валюта");  EditField(h,vm=(v=6),80, "Проект",St_i,PRCode,false,0);  EditField(h2,v,-40, "Наменув.",ViewOnly,PRName,false,0);  Tile(1,220,true,"1",PRCode);  EditField(h,v,80, "Товар",Normal,ArtCode,false,0);  EditField(h2,v,80,"Група",Normal,INGroup,false,0);  EditField(h,v+=vs,80,"Співробітник",Normal,EMCode,false,0);  EditField(h,v+=vs,80,"Номер",Normal,SerNr,true,0);  EditField(h2,v,80,"Дата",Normal,TransDate,false,0);  EditField(h,v+=vs,80,"Акт/накладна після",Normal,InvAfter,false,0);  EditField(h2,v,80,"Дата акту/накл.",Normal,InvDate,false,0);  EditField(h,v+=vs,80,"Акт/накладна",Normal,Invoice,false,0);  CheckBox(h+140,v,0,"Окремий рядок акту/накл.",InvSeparately);  EditField(h,v+=vs,250,"Об'єкти",Normal,Objects,false,ObjSClass);  EditField(h,v2=(v+=vs),250,"Коментар",Normal,Comment,false,0);  EditField(h,v+=vs,250,"",Normal,Comment1,false,0);  EditField(h,v+=vs,250,"",Normal,Comment2,false,0);  EditField(h,v+=vs,50,"Фаза",Normal,PRStage,false,0);  EditField(h,v+=vs,50,"Рахунок WIP",Normal,WIPAcc,false,0);  EditField(h2,v,50,"Сальдо WIP рах-ка",Normal,WIPBalAcc,false,0);  ButtonFrame(h=400,v=vm+16,120,7,"Реєстр");  RadioButton(h,v,1,0,"Таблиця часу",oVc);  RadioButton(h,v+=16,2,255,"Акт/накладна постачальника",oVc);  RadioButton(h,v+=16,3,255,"Авансовий звіт",oVc);  RadioButton(h,v+=16,4,255,"Відвантаження",oVc);  RadioButton(h,v+=16,5,255,"Діяльність",oVc);  RadioButton(h,v+=16,6,255,"Повернені товари",oVc);  RadioButton(h,v+=16,7,255,"Списання зі складу",oVc);  ButtonFrame(h=400,v+=40,120,4,"Тип товару");  RadioButton(h,v,3,0,"послуга",ItemType);  RadioButton(h,v+=16,0,0,"придбання",ItemType);  RadioButton(h,v+=16,1,0,"враховується на складі",ItemType);  RadioButton(h,v+=16,5,0,"матеріал",ItemType);  StaticText(h=20,v=(v2+121),  "Кіл-ть",false);  StaticText(h+=60,v,  "В накл.",false);  StaticText(h+=60,v,  "Ціна",false);  StaticText(h+=80,v,  "% знижки",false);  StaticText(h+=60,v,  "Надбавка",false);  StaticText(h+=60,v,  "Сума",false);  StaticText(h+=80,v,  "Вартість",false);  StaticText(h+=80,v,  "Сума",false);  StaticText(h+=80,v,  "Прибуток",false);  EditField(h=20,v+=10,40,"",Normal,Qty,true,0);  EditField(h+=60,v,40,"",Normal,InvQty,true,0);  EditField(h+=60,v,60,"",Normal,Price,true,0);  EditField(h+=80,v,40,"",Normal,Discount,true,0);  EditField(h+=60,v,40,"",Normal,Markup,true,0);  EditField(h+=60,v,60,"",Normal,Sum,true,0);  EditField(h+=80,v,60,"",Normal,CostPrice,true,0);  SoftEditField(h+=80,v,60,"",ViewOnly,"CostPriceSum",true,0,M4Val,255);  EditField(h+=80,v,60,"",Normal,GP,true,0);  EditField(h=80,v+=20,40,"Валюта",ViewOnly,CurncyCode,true,0);  EditField(h=140,v,60,"",Normal,PriceInCur,true,0);  EditField(h+=80,v,40,"",Normal,Discount,true,0);  EditField(h+=60,v,40,"",Normal,MarkupInCur,true,0);  EditField(h+=60,v,60,"",Normal,SumInCur,true,0);  EditField(h+=80,v,60,"",Normal,CostPriceInCur,true,0);  SoftEditField(h+=80,v,60,"",ViewOnly,"CostPriceInCurSum",true,0,M4Val,255);  EditField(h+=80,v,60,"",Normal,GPInCur,true,0);  Tile(2,70,true,"2",FrRate);  vs = 20;  EditField(h=110,v=6,50,"Валюта",ViewOnly,CurncyCode,false,CurncyCodeSClass);  EditField(h2=295,v,50,"Курс",ViewOnly,FrRate,true,0);  EditField(h3=360,v,50,":",ViewOnly,ToRateB1,true,0);  StaticText(h3+60,v+12,"Осн. вал. 1",false);  EditField(h,v+=vs,50,"Осн. вал. 1",ViewOnly,BaseRate1,true,0);  EditField(h3,v,50,":",ViewOnly,ToRateB2,true,0);  StaticText(h3+60,v+12,"Осн. вал. 2",false);  EditField(h,v+=vs,50,"Осн. вал. 2",ViewOnly,BaseRate2,true,0);  SpecialMenu("Відкрити реєстр",'e',0,"OpenRegisterFromTBIVDsm");  SpecialMenu("Розподілити записи операцій по проекту",'t',0,"OpenSplitTBIV");  EndWindow;  WindowBegin("Записи операцій по проекту",TBIVLClass,CGmlist,-);  SpawnClass(TBIVDClass);  SetWRect(64,80,600,298);  Sizeable(-1,-1,0,0);  UseView(TBIVVc);  RecordList(4,17,-21,-39);  RlColKey(4,4,    "Проект",PRCode,false,MainKey);  RlColKey(121,121,"Товар",ArtCode,false,ArtCode);  RlColKey(184,184,"Співроб.",EMCode,false,EMCode);  RlColKey(234,234,"Дата",TransDate,false,TransDate);  RlCol   (314,314,"Акт/накл. після",InvAfter,false);  RlColKey(-150,-150,"Найменування",PRName,false,PRName);  SearchField("Пошук");  EndWindow;  WindowBegin("Бюджет проекту",TBBUDClass,CGview,-);  SetWRect(20,80,640,410);  Sizeable(-1,-1,0,0);  UseView(TBBUVc);//  FormName(TBBudgetForm);//why  vs=20; h=100; h2=260; h1=50;  Tile(0,90,false,"",PRCode);  EditField(h,v=6,80, "Проект",St_i,PRCode,false,PRSClass);  EditField(h2,v,240, "Опис",Normal,PRName,false,0);  EditField(h,v+=vs,80, "Клієнт",St_i,CustCode,false,CUSClass);  EditField(h2,v,240, "Найменування",Normal,CustName,false,0);  EditField(h,v+=vs,80, "Дата операції",Normal,TransDate,false,PasteCurDate);  EnterSkip(Math);  TileButton(1,"Акти/накл.");  TileButton(2,"Товари");  TileButton(3,"Валюта");  TileButton(4,"Текст");    TileButton(5,"Учасники");    Tile(1,65,false,"1",Math);  ButtonFrame(h1,vm=(v=20),120,2,"Час акту/накл.");  RadioButton(h1,v,0,0,"реально",BudTime);  RadioButton(h1,v+=16,1,255,"в бюджеті",BudTime);  ButtonFrame(h1+=140,v=vm,120,2,"Склад.товари накл.");  RadioButton(h1,v,0,0,"реальні",BudStocked);  RadioButton(h1,v+=16,1,255,"в бюджеті",BudStocked);  ButtonFrame(h1+=140,v=vm,120,2,"Матеріали акту/накл.");  RadioButton(h1,v=vm,0,0,"реальні",BudMaterial);  RadioButton(h1,v+=16,1,255,"в бюджеті",BudMaterial);  ButtonFrame(h1+=140,v=vm,120,2,"Придбання акту/накл.");  RadioButton(h1,v,0,0,"реальні",BudOther);  RadioButton(h1,v+=16,1,255,"в бюджеті",BudOther);  Tile(2,120,true,"2",Math);  v=6; h = 20;  MatrixBegin(h,vm=(v+=16),-50,-36,-,199);  MatTypedRow(stp);  Flip(0);  MatText(t=9,30,"Разом",true);  MatCol(t,100,"",0,Spec,false,0);  MatCol(t,-140,"Сума",0,Sum,true,0);  MatCol(t,-70,"Вар-ть",0,Cost,true,0);  MatText(t=17,30,"Заголовок",true);  MatCol(t,100,"",0,Spec,false,0);  MatCol(1,30,"Товар",0,ArtCode,false,INSClass);  MatCol(1,100,"Особа",0,EMCode,false,UserSClass);  MatCol(1,155,"К-ть",0,Qty,true,0);  MatCol(1,200,"Коментар",0,Comment,false,0);  Flip(1);  MatCol(1,-285,"Ціна",0,Price,true,0);  MatCol(1,-215,"%",0,Discount,true,0);  MatCol(1,-175,"Сума",0,Sum,true,0);/* Invoiced should be changeable, but I put it on this flip only. */  MatCol(1,-100,"Фаза",0,PRStage,false,PRStageSClass);  MatCol(1,-50,"Співробітник",0,PRStageSign,false,UserSClass);  Flip(2);  MatCol(1,-235,"Надб.",0,Markup,true,0);  MatCol(1,-180,"Вар-ть",0,Cost,true,0);  MatCol(1,-115,"Приб.",0,GP,true,0);  MatCol(1,-50,"Акт/накл.",0,Invoiced,true,0);//  MatColTL(1,-50,"Inv. No.",0,-1,0,-1,Invoiced,true,0);  Flip(3);  MatCol(1,-255,"Клас часу",0,TimeClass,false,TimeClassSClass);  MatCol(1,-185,"Вид",0,BudType,false,SetSClass);  MatCol(1,-115,"Нак після",0,InvAfter,false,PasteCurDate);  MatCol(1,-50,"Акт/накл.",0,Invoiced,true,0);//  MatColTL(1,-50,"Inv. No.",0,-1,0,-1,Invoiced,true,0);  Flip(4);  MatCol(1,-235,"Об'єкти",0,Objects,false,ObjSClass);  MatCol(1,-115,"Дата нак",0,InvDate,false,PasteCurDate);  MatCol(1,-50,"Акт/накл.",0,Invoiced,true,0);//  MatColTL(1,-50,"Inv. No.",0,-1,0,-1,Invoiced,true,0);  Flip(5);  MatCol(1,-115,"Маржа",0,GM,false,0);  MatCol(1,-50,"Акт/накл.",0,Invoiced,true,0);//  MatColTL(1,-50,"Inv. No.",0,-1,0,-1,Invoiced,true,0);  DeleteRowTest;  EndMatrix;  vs = 22;  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,2,"B");  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,3,"C");  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,4,"D");  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,5,"E");  EditField(63,-25,50,"Валюти",Normal,CurncyCode,false,CurncyCodeSClass);  EditField(200,-45,80, "Час",Normal,SumTime,true,0);  EditField(200,-25,80, "Матеріали",Normal,SumMaterial,true,0);  EditField(390,-45,80, "Товари складу",Normal,SumStocked,true,0);  EditField(390,-25,80, "Закупки",Normal,SumOther,true,0);  EditField(580,-45,80, "Націнка",Normal,Markup,true,0);  EditField(580,-25,80, "Разом сума",Normal,TotSum,true,0);  Tile(3,70,false,"3",FrRate);  vs = 20;  EditField(h=110,v=6,50,"Валюта",Normal,CurncyCode,false,CurncyCodeSClass);  EditField(h2=295,v,50,"Курс",Normal,FrRate,true,0);  EditField(h3=360,v,50,":",Normal,ToRateB1,true,0);  StaticText(h3+60,v+12,"Осн. вал. 1",false);  EditField(h,v+=vs,50,"Осн. вал. 1",Normal,BaseRate1,true,0);  EditField(h3,v,50,":",Normal,ToRateB2,true,0);  StaticText(h3+60,v+12,"Осн. вал. 2",false);  EditField(h,v+=vs,50,"Осн. вал. 2",Normal,BaseRate2,true,0);  Tile(4,210,false,"4",Text0);  vs=20; h=100; h2=260; h1=50;  EditField(h,v=6,-20,"Текст",Normal,Text0,false,0);  EditField(h,v+=20,-20,"",Normal,Text1,false,0);  EditField(h,v+=20,-20,"",Normal,Text2,false,0);  EditField(h,v+=20,-20,"",Normal,Text3,false,0);  EditField(h,v+=20,-20,"",Normal,Text4,false,0);  EditField(h,v+=20,-20,"",Normal,Text5,false,0);  EditField(h,v+=20,-20,"",Normal,Text6,false,0);  EditField(h,v+=20,-20,"",Normal,Text7,false,0);  EditField(h,v+=20,-20,"",Normal,Text8,false,0);  EditField(h,v+=20,-20,"",Normal,Text9,false,0);  Tile(5,120,false,"5",Members);  EditField(h,vm=(v=6),-170,"Учасники пр.",ViewOnly,Members,false,0);  EditField(h,v+=vs,50,"Керівник",Normal,PRLeader,false,0);  EditField(h,v+=vs,50,"Мова",Normal,LangCode,false,LangSClass);  EditField(h2,v=vm+vs,50,"Продавець",Normal,SalesMan,false,UserSClass);  EditField(h2,v+=vs,50,"Група продажу",Normal,SalesGroup,false,SalesGroupSClass);  ButtonFrame(h3=570,v=16,123,6,"Статус затвердження");  RadioButton(h3,v,kAcceptanceStateNotRequired,0,"не потрібно",AcceptanceStatus);  RadioButton(h3,v+=16,kAcceptanceStateNotStarted,0,"не розпочато",AcceptanceStatus);  RadioButton(h3,v+=16,kAcceptanceStateNotRequested,0,"не було запиту",AcceptanceStatus);  RadioButton(h3,v+=16,kAcceptanceStatePending,0,"очікування",AcceptanceStatus);  RadioButton(h3,v+=16,kAcceptanceStateApproved,0,"затверджено",AcceptanceStatus);  RadioButton(h3,v+=16,kAcceptanceStateRejected,0,"незатверджено",AcceptanceStatus);    SpecialMenu("Додати заголовок",' ',0,"HeaderLineTBBUDsm");  SpecialMenu("Додати разом",' ',0,"SubtotalTBBUDsm");  SpecialMenu("Відправити для затвердження",' ',6,"TBBUSendforAcceptanceTBBUDsm");  SpecialMenu("Створити замовлення постачальнику",'u',1,"POFromTBBUDsm");  SpecialMenu("Створити рахунок клієнту",'l',2,"ORFromTBBUDsm");  SpecialMenu("Статус товару",'I',3,"ItemStatusTBBUDsm");  SpecialMenu("Звіт по бюджету",'r',4,"TBBUStatusReport");  SpecialMenu("Створити акт/накл.",'F',5,"IVFromTBBUDsm");  SpecialMenu("Створити акт/накл. для заверш. фаз",'f',6,"IVFromTBBUCompleteDsm");  EndWindow;  WindowBegin("Бюджети проектів",TBBULClass,CGmlist,-);  SpawnClass(TBBUDClass);  SetWRect(64,80,700,298);  Sizeable(-1,-1,0,0);  UseView(TBBUVc);  RecordList(4,17,-21,-39);  RlColKey(4,4,    "Проект",PRCode,false,MainKey);  RlColKey(81,81,"Дата",TransDate,false,TransDate);  RlColKey(150,150,"Продавець",SalesMan,false,SalesMan);  RlColKey(220,220,"Найменування",PRName,false,PRName);  RlColKey(-210,-210,"Клієнт",CustCode,false,CustCode);  RlColKey(-160,-160,"Найменув. клієнта",CustName,false,CustName);  RlCol(-85,-35,"Разом",TotSum,true);  SearchField("Пошук");  BrowseSubsetButton(-40,-15);  EndWindow;  WindowBegin("Фази проекту",PRStageDClass,CGview,-);  SetWRect(64,80,509,150);  UseView(PRStageVc);  EditField(120,v=6,50,"Код",St_i,Code,false,0);  EditField(120,v+=20,300,"Коментар",Normal,Comment,false,0);  EndWindow;  WindowBegin("Фази проекту",PRStageLClass,CGmlist,-);  SetWRect(64,80,509,298);  SpawnClass(PRStageDClass);  Sizeable(-1,-1,0,0);  UseView(PRStageVc);  RecordList(4,17,-21,-39);  RlColKey(4,4,  "Код",Code,false,Code);  RlColKey(81,81,"Коментар",Comment,false,Comment);  SearchField("Пошук");  EndWindow;  WindowBegin("Визначте фази проекту",PRStageSClass,CGslist,-);  SetWRect(240,80,600,298);  Sizeable(-1,-1,0,0);  UseView(PRStageVc);  SpawnClass(PRStageDClass);  RecordList(4,17,-21,-39);  RlColKey(4,4,  "Код",Code,false,Code);  RlColKey(81,81,"Коментар",Comment,false,Comment);  SearchField("Пошук");  EndWindow;    WindowBegin("Класифікація проекту",PRClDClass,CGview,-);  SetWRect(64,80,509,150);  UseView(PRClVc);  EditField(120,v=6,50,"Код",St_i,Code,false,0);  EditField(120,v+=20,290,"Коментар",Normal,Comment,false,0);  EditField(120,v+=20,50,"Тип",Normal,CType,false,PRClTypeSClass);  EndWindow;  WindowBegin("Класифікації проектів",PRClLClass,CGmlist,-);  SetWRect(64,80,509,298);  SpawnClass(PRClDClass);  Sizeable(-1,-1,0,0);  UseView(PRClVc);  RecordList(4,17,-21,-39);  RlColKey(4,4,  "Код",Code,false,Code);  RlColKey(84,84,  "Тип",CType,false,CType);  RlColKey(164,164,"Коментар",Comment,false,Comment);  SearchField("Пошук");  EndWindow;  WindowBegin("Визначте класифікацію проекту",PRClSClass,CGslist,-);  SetWRect(64,80,509,298);  Sizeable(-1,-1,0,0);  UseView(PRClVc);  SpawnClass(PRClDClass);  RecordList(4,17,-21,-39);  RlColKey(4,4,  "Код",Code,false,Code);  RlColKey(84,84,  "Тип",CType,false,CType);  RlColKey(164,164,"Коментар",Comment,false,Comment);  SearchField("Пошук");  EndWindow;  WindowBegin("Тип класифікації проекту",PRClTypeDClass,CGview,-);  SetWRect(64,80,509,150);  UseView(PRClTypeVc);  EditField(120,v=6,50,"Код",St_i,Code,false,0);  EditField(120,v+=20,300,"Коментар",Normal,Comment,false,0);  EndWindow;  WindowBegin("Типи класифікацій проекту",PRClTypeLClass,CGmlist,-);  SetWRect(64,80,509,298);  SpawnClass(PRClTypeDClass);  Sizeable(-1,-1,0,0);  UseView(PRClTypeVc);  RecordList(4,17,-21,-39);  RlColKey(4,4,  "Код",Code,false,Code);  RlColKey(81,81,"Коментар",Comment,false,Comment);  SearchField("Пошук");  EndWindow;  WindowBegin("Визначте тип класифікації проекту",PRClTypeSClass,CGslist,-);  SetWRect(240,80,600,298);  Sizeable(-1,-1,0,0);  UseView(PRClTypeVc);  SpawnClass(PRClTypeDClass);  RecordList(4,17,-21,-39);  RlColKey(4,4,  "Код",Code,false,Code);  RlColKey(51,51,"Коментар",Comment,false,Comment);  SearchField("Пошук");  EndWindow;  WindowBegin("Визначте обов'язкові класифікації",AssPRClSClass,CGother,RcType);  ToolBar;  PushButton(-70,5,-10,22,ToolOK,"OK");  EndToolBar;  DynamicWindow;  UseView(RcVc);  SetWRect(164,80,524,344);  h = 130;vs =20;  StaticText(h-8,v=16,"Клас проекту",true);  label = UserDefined("AssPRClSClass","0");  StaticText(h+60,v,label,true);  StaticText(h-8,v+=20,"Обов'язкові",true);  StaticText(h,v,"Класифікація",false);  label = UserDefined("AssPRClSClass","1");  if (nonblank(label)) then begin    EditField(h,v+=vs,-20,label,Normal,f1,false,PRClBTSClass);  end;  label = UserDefined("AssPRClSClass","2");  if (nonblank(label)) then begin    EditField(h,v+=vs,-20,label,Normal,f2,false,PRClBTSClass);  end;  label = UserDefined("AssPRClSClass","3");  if (nonblank(label)) then begin    EditField(h,v+=vs,-20,label,Normal,f3,false,PRClBTSClass);  end;  label = UserDefined("AssPRClSClass","4");  if (nonblank(label)) then begin    EditField(h,v+=vs,-20,label,Normal,f4,false,PRClBTSClass);  end;  label = UserDefined("AssPRClSClass","5");  if (nonblank(label)) then begin    EditField(h,v+=vs,-20,label,Normal,f5,false,PRClBTSClass);  end;  label = UserDefined("AssPRClSClass","6");  if (nonblank(label)) then begin    EditField(h,v+=vs,-20,label,Normal,ObjStr,false,PRClBTSClass);  end;  label = UserDefined("AssPRClSClass","7");  if (nonblank(label)) then begin    EditField(h,v+=vs,-20,label,Normal,Stext,false,PRClBTSClass);  end;  label = UserDefined("AssPRClSClass","8");  if (nonblank(label)) then begin    EditField(h,v+=vs,-20,label,Normal,LastAcc,false,PRClBTSClass);  end;    EditField(h,v+=30,-20,"Додатково",Normal,f6,false,PRClSClass);      EndWindow;    WindowBegin("Визначте класифікацію",PRClBTSClass,CGother,RcType);  Sizeable(-1,-1,0,0);  SetWRect(240,80,470,298);  StringList(9,9,-20,-20);  EndWindow;   WindowBegin("Тексти полів, що задає кор-ч - Менеджери проекту",PrManagerLabelTClass,CGSbl,-);  SetBlid(PrManagerLabelBlock);  SetWRect(64,80,580,200);  v = 6; h = 130;  EditField(h,v=6,-20,"Менеджер проекту 1",Normal,PrManager1Label,false,0);  EditField(h,v+=20,-20,"Менеджер проекту 2",Normal,PrManager2Label,false,0);  EditField(h,v+=20,-20,"Менеджер проекту 3",Normal,PrManager3Label,false,0);  EditField(h,v+=20,-20,"Менеджер проекту 4",Normal,PrManager4Label,false,0);  EditField(h,v+=20,-20,"Менеджер проекту 5",Normal,PrManager5Label,false,0);  EndWindow;  WindowBegin("Пошук проекту",SearchPRRClass,CGRcW,RcType);  SetWRect(64,80,509,198);  vs =20;h=100;v=5;  EditFieldTL(h,v ,200,"Наймен-ня",M4Str,Normal,40,f1,false,0);  EditFieldTL(h,v+=vs ,120,"Клієнт",M4UStr,Normal,20,f4,false,CUSClass);  EditFieldTL(h,v+=vs ,120,"Керівник",M4UStr,Normal,10,f3,false,UserSClass);  EndWindow;  WindowBegin("Визначте премію по проекту",ProjBonusRClass,CGRcW,RcType);  SetWRect(20,80,450,220);  v = 6; vs = 20; h = 120;  PeriodField(h,v,"Період");  EditFieldTL(h,v+=vs, 150,"Викл. клас товару",M4UStr,Normal,20,f1,false,DISClass);  EditFieldTL(h,v+=vs, 60,"Особа",M4UStr,Normal,10,f2,false,UserSClass);  EditFieldTL(h,v+=vs, 60,"% премії",M4Val,Normal,0,vals0,false,0);  ButtonFrame(h,v+=40,123,2,"Період");  RadioButton(h,v,0,0,"Акт/накладна у період",flags[1]);  RadioButton(h,v+=16,1,0,"Сплачено у період",flags[1]);  EndWindow;  WindowBegin("Specify Fix Incorrect PlanProd History Records",FixPlanProdVClass,CGMnt,RcType);  SetWRect(20,80,400,200);  CheckBox(20,v=20,0,"Виробництво",flags[1]);  CheckBox(20,v+=20,0,"Замовлення на виробництво",flags[2]);  EndWindow;  WindowBegin("Додати утримання по проекту",AddPRRetentionDClass,CGother,RcType);  SetWRect(20,80,330,110);  ToolBar;  h = -149;  HalPushButton(h,5,h+60,25,"AddPRRetentionDClassCancel","Скасувати");  h = -76;  HalPushButton(h,5,h+60,25,"AddPRRetentionDClassSave","Зберегти");  EndToolBar;  vs = 20; h=100;  EditFieldTL(h,v=6, 100,"Проект",M4UStr,Normal,20,f1,false,PRSClass);  EndWindow;  WindowBegin("Визначте порівн. фатичних даних із бюдж. проекту",PRActBudRClass,CGRcW,RcType);  SetWRect(20,80,470,300);  vs = 20;  EditFieldTL(h=150,v=6, 150,"Проект",   M4Str,Normal,21,f1,false,PRSClass);  EditFieldTL(h,v+=vs, 80,"З",M4Date,Normal,0,d1,false,PasteCurDate);  EditFieldTL(h+108,v,80, "по",M4Date,Normal,0,d2,false,PasteCurDate);  EditFieldTL(h,v+=vs,80,"ксас проекту",   M4UStr,Normal,10,FirstAcc,false,PRClassSClass);  EditFieldTL(h,v+=vs,80,"класифікация проекту",   M4UStr,Normal,10,LastAcc,false,PRClSClass);  EditFieldTL(h,v+=vs,80,"лідер проекту", M4UStr,Normal,10,AccStr,false,UserSClass);  EditFieldTL(h,v+=vs,80,"фаза", M4UStr,Normal,10,Stext,false,PRStageSClass);  EditFieldTL(h,v+=vs, 150,"Група товарів",   M4UStr,Normal,30,f2,false,INSClass);    ButtonFrame(h=50,vm=(v+=40),123,3,"Функція");  RadioButton(h,v,0,0,"зведений",ArtMode);  RadioButton(h,v+=16,1,0,"тип товару",ArtMode);  RadioButton(h,v+=16,2,0,"товар",ArtMode);  ButtonFrame(h=250,v=vm,123,2,"Функція");  RadioButton(h,v,0,0,"кількість",flags[3]);  RadioButton(h,v+=16,1,0,"суми",flags[3]);  CheckBox(h=250,v+=30,0,"Включити підпроекти",flags[0]);  CheckBox(h,v+=16,0,"Включити завершені проетки",flags[1]);  CheckBox(h,v+=16,0,"Суми у валюті",flags[2]);  EndWindow;  WindowBegin("Визначення виручки від проекту",PRRevRecRClass,CGRcW,RcType);  SetWRect(20,80,415,367);  v = 6; vs = 20; h = 120;  EditFieldTL(h,v, 150,"Проект",   M4UStr,Normal,60,f1,false,PRSClass);  EditFieldTL(h,v+=vs, 150,"Керівник",   M4UStr,Normal,20,f2,false,UserSClass);  EditFieldTL(h,v+=vs, 150,"Клієнт",   M4UStr,Normal,50,f3,false,CUSClass);  EditFieldTL(h,v+=20, 150,"Клас",   M4UStr,Normal,5,FirstAcc,false,PRClassSClass);  EditFieldTL(h,v+=20, 150,"Продавець",   M4UStr,Normal,10,LastAcc,false,UserSClass);  EditFieldTL(h,v+=20, 150,"Група продажу",   M4UStr,Normal,10,f4,false,SalesGroupSClass);  ButtonFrame(h=50,vm=(v+=41),143,2,"Статус проекта");  CheckBox(h,v=vm,0,"Активні проекти",flags[19]);  CheckBox(h,v+=16,0,"Завеш. проекти",flags[20]);  ButtonFrame(h,vm=v+40,143,3,"Тип проекта");  CheckBox(h,v=vm,0,"виствл. акт/накл.",flags[10]);  CheckBox(h,v+=18,0,"внутр.",flags[11]);  CheckBox(h,v+=18,0,"Інші",flags[12]);  ButtonFrame(h=220,v=(vm-55),123,4,"Сортувати за");  RadioButton(h,v,0,0,"проектом",flags[1]);  //RadioButton(h,v+=16,1,0,"Customer Code",flags[1]); //Code is there to sort, column not visible in report  RadioButton(h,v+=16,2,0,"найменув. проетка",flags[1]);  RadioButton(h,v+=16,3,0,"найменув. клієнта",flags[1]);  RadioButton(h,v+=16,4,0,"керівником пр.",flags[1]);  CheckBox(h,v+=30,0,"Включ. підпроеткти",IncDaughter);  CheckBox(h,v+=16,0,"Суми у валюті",flags[2]);  ButtonFrame(h,v+=40,123,2,"Відображати");  RadioButton(h,v,0,0,"вал. проекта",flags[3]);  RadioButton(h,v+=16,1,0,"групу продажів",flags[3]);  EndWindow;  WindowBegin("Графік проекту",PRScheduleDClass,CGview,-);  SetWRect(20,80,640,410);  Sizeable(-1,-1,0,0);  UseView(PRScheduleVc);  FormName(PRScheduleForm);  vs=20; h=120; h2 = 330; h3 = 565; h4 = 450;  Tile(0,60,false,"",PRCode);  EditField(h,v=6,120, "Проект",St_i,PRCode,false,PRSClass);  EditField(h2, v, 80, "Версія", ViewOnly, VersionNr, false, 0);  EditField(h2+150,v,80, "Дата",Normal,TransDate,false,PasteCurDate);  CheckBox(h+500,v,0,"Закрито",Closed);  TileButton(1,"Деталі");  TileButton(2,"Графік");  TileButton(3,"Адреса");  Tile(1,70,false,"1",PRName);  EditField(h,v=6,120, "Проект",Normal,PRCode,false,PRSClass);  EditField(h2,v,240, "Описан.",Normal,PRName,false,0);  EditField(h,v+=vs,120, "Клієнт",ViewOnly,CustCode,false,0);  EditField(h2,v,240, "Наймен.",ViewOnly,CustName,false,0);  EditField(h,v+=vs,120, "Контакт",Normal,CustContact,false,ContactSClass);  Tile(2,140,true,"3",Math);  v=v+vs; h = 20;  MatrixBegin(h,10,-50,-30,-,199);  MatTypedRow(stp);  Flip(0);  MatCol(t=1,30,"Фаза",0,PRStage,false,PRStageSClass);  MatCol(t,70,"Коментар",0,PRStageComment,false,0);  MatCol(t,-440,"Дата початку",0,StartDate,false,PasteCurDate);  MatCol(t,-360,"Трив-ть",0,DurDays,true,0);  MatCol(t,-300,"Дата заверш.",0,EndDate,false,PasteCurDate);  MatText(t=17,30,"Заголовок",true);  MatCol(t,100,"",0,PRStageComment,false,0);  Flip(1);  MatCol(t=1,-220,"Відпов-ний",0,Responsible,false,UserSClass);  MatCol(t,-180,"Години/День",0,HoursPerDay,true,0);  MatCol(t,-105,"%",0,Complete,true,0);  MatCol(t,-60,"Підпис",0,PRStageSign,false,UserSClass);  Flip(2);  MatCol(t=1,-200,"Крайн. срок",0,DueDate,false,PasteCurDate);  DeleteRowTest;  EndMatrix;  vs = 20;  v = 6+18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,2,"B");  v = -25;  EditField(-400,v,50,"Усьго %",ViewOnly,TotalPerc,false,0);  EditField(-255,v,50,"% завершено",ViewOnly,CompletePerc,false,0);  EditField(-90,v,50,"% незваершено",ViewOnly,OutstandingPerc,false,0);  Tile(3,130,false,"4",InvAddr0); vs = 20;  label = UserDefined("CUVc","InvAddr0");  if (blank(label)) then begin label = "Адреса"; end;  EditField(h=120,v=6,-20,label,Normal,InvAddr0,false,0);  label = UserDefined("CUVc","InvAddr1");  EditField(h,v+=vs, -20,label,Normal,InvAddr1,false,0);  label = UserDefined("CUVc","InvAddr2");  EditField(h,v+=vs, -20,label,Normal,InvAddr2,false,0);  label = UserDefined("CUVc","InvAddr3");  EditField(h,v+=vs, -20,label,Normal,InvAddr3,false,0);  label = UserDefined("CUVc","InvAddr4");  EditField(h,vm=(v+=vs), -20,label,Normal,InvAddr4,false,0);  EditField(h,vm=(v+=vs), -20,"Учасн. пр.",ViewOnly,Members,false,0);  SpecialMenu("Додати заголовок",' ',0,"HeaderLinePRScheduleDsm");//  SpecialMenu("Print Schedule Time Line",' ',0,"PrintScheduleTLDsm");//  SpecialMenu("Create New Version",'c',1,"NewVersionNBScheduleDsm");//  SpecialMenu("Approve",'a',1,"NBScheduleApproveDsm");//  SpecialMenu("Create Deadlines",' ',1,"NBScheduleCreateDeadlinesDsm");  EndWindow;  WindowBegin("Графіки проектів",PRScheduleLClass,CGmlist,-);  SpawnClass(PRScheduleDClass);  SetWRect(64,80,650,298);  Sizeable(-1,-1,0,0);  UseView(PRScheduleVc);  RecordList(4,17,-21,-39);  RlColKey(4,4, "Проект",PRCode,false,PRCode);  RlCol   (80,80, "Версія",VersionNr,false);  RlColKey(125,125,"Дата",TransDate,false,TransDate);  RlColKey(200,200,"Описан.",PRName,false,PRName);  RlColKey(-230,-230,"Кліент",CustCode,false,CustCode);  RlColKey(-160,-160,"Наймен.",CustName,false,CustName);  SearchField("Пошук");  EndWindow;  WindowBegin("Визначення графіка проекта",PRScheduleFClass,CGHbl,HBlRecType);  SetBlid(PRScheduleDefBlock);  SetWRect(20,80,600,298);  Sizeable(-1,-1,0,0);  MatrixBegin(5,27,-21,-20,FormDefRowType,99);  MatCol(1,24,"Seq.",0,intdocnr,false,0);  MatCol(1,54,"Мова",0,LangCode,false,LangSClass);  MatCol(1,94,"Гр. дост.",0,UserGroup,false,AccessSClass);  MatCol(1,154,"Сер. №",0,SerNr,false,0);  MatCol(1,224,"Друк",0,FPCode,false,DocSClass);/* No code behind this *///  MatCol(1,324,"E-Form",0,EformCode,false,0);  MatCol(1,424,"Принтер",0,PrintGroupCode,false,PrintGroupSClass);  MatCol(1,-60,"Статус",0,Typ,false,SetSClass);  EndMatrix;  EndWindow;  WindowBegin("Визначте графіки проекту",PRScheduleRClass,CGRcW,RcType);  SetWRect(64,80,440,100);  vs = 20;  EditFieldTL(h=130,v=6,150,"Проект",M4UStr,Normal,20,f1,false,PRSClass);  EndWindow;  return;end;